<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriele Filomena">
<meta name="dcterms.date" content="2024-11-11">

<title>Exploring the Social World - Quantitative Block: Statistics - 1&nbsp; Lab: Introduction to R for Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../labs/02.MultipleLinear.html" rel="next">
<link href="../general/assessment.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../labs/01.introR.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Lab: Introduction to R for Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Exploring the Social World - Quantitative Block: Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/GDSL-UL/stats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../Exploring-the-Social-World---Quantitative-Block--Statistics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assessment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/01.introR.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Lab: Introduction to R for Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/02.MultipleLinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lab: Correlation, Single, and Multiple Linear Regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r" id="toc-r" class="nav-link active" data-scroll-target="#r"><span class="header-section-number">1.1</span> R?</a></li>
  <li><a href="#rstudio-basics" id="toc-rstudio-basics" class="nav-link" data-scroll-target="#rstudio-basics"><span class="header-section-number">1.2</span> R(Studio) Basics</a>
  <ul class="collapse">
  <li><a href="#starting-a-session-in-rstudio" id="toc-starting-a-session-in-rstudio" class="nav-link" data-scroll-target="#starting-a-session-in-rstudio"><span class="header-section-number">1.2.1</span> Starting a session in RStudio</a></li>
  <li><a href="#using-the-console" id="toc-using-the-console" class="nav-link" data-scroll-target="#using-the-console"><span class="header-section-number">1.2.2</span> Using the console</a></li>
  <li><a href="#r-as-a-simple-calculator" id="toc-r-as-a-simple-calculator" class="nav-link" data-scroll-target="#r-as-a-simple-calculator"><span class="header-section-number">1.2.3</span> R as a simple calculator</a></li>
  <li><a href="#variables-assignment" id="toc-variables-assignment" class="nav-link" data-scroll-target="#variables-assignment"><span class="header-section-number">1.2.4</span> Variables Assignment</a></li>
  <li><a href="#working-with-scripts" id="toc-working-with-scripts" class="nav-link" data-scroll-target="#working-with-scripts"><span class="header-section-number">1.2.5</span> Working with Scripts</a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages"><span class="header-section-number">1.2.6</span> R Packages</a></li>
  </ul></li>
  <li><a href="#practice-dataset-and-dataframes" id="toc-practice-dataset-and-dataframes" class="nav-link" data-scroll-target="#practice-dataset-and-dataframes"><span class="header-section-number">1.3</span> Practice: Dataset and Dataframes</a>
  <ul class="collapse">
  <li><a href="#datasets-in-r" id="toc-datasets-in-r" class="nav-link" data-scroll-target="#datasets-in-r"><span class="header-section-number">1.3.1</span> Datasets in R</a></li>
  <li><a href="#importing-data-in-r" id="toc-importing-data-in-r" class="nav-link" data-scroll-target="#importing-data-in-r"><span class="header-section-number">1.3.2</span> Importing Data in R</a></li>
  </ul></li>
  <li><a href="#practice-descriptive-statistics" id="toc-practice-descriptive-statistics" class="nav-link" data-scroll-target="#practice-descriptive-statistics"><span class="header-section-number">1.4</span> Practice: Descriptive Statistics</a>
  <ul class="collapse">
  <li><a href="#summarizing-data" id="toc-summarizing-data" class="nav-link" data-scroll-target="#summarizing-data"><span class="header-section-number">1.4.1</span> Summarizing Data</a></li>
  <li><a href="#understanding-the-structure-of-the-frs-datafile" id="toc-understanding-the-structure-of-the-frs-datafile" class="nav-link" data-scroll-target="#understanding-the-structure-of-the-frs-datafile"><span class="header-section-number">1.4.2</span> Understanding the Structure of the FRS Datafile</a></li>
  <li><a href="#explore-the-distribution-of-your-outcome-variable" id="toc-explore-the-distribution-of-your-outcome-variable" class="nav-link" data-scroll-target="#explore-the-distribution-of-your-outcome-variable"><span class="header-section-number">1.4.3</span> Explore the Distribution of Your Outcome Variable</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/GDSL-UL/stats/edit/main/labs/01.introR.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Lab: Introduction to R for Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriele Filomena </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 11, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><em>The following material has been readapted from</em>:</p>
<ul>
<li>https://dereksonderegger.github.io/570L/1-introduction.html by Derek L. Sonderegger;</li>
<li>https://pietrostefani.github.io/gds/environR.html by Elisabetta Pietrostefani and Carmen Cabrera-Arnau.*</li>
</ul>
<p>The lecture’s slides can be found <a href="https://github.com/GDSL-UL/stats/blob/main/lectures/lecture07.pdf">here</a>.</p>
<p>For the lab sessions and your assignment, you will need the following software:</p>
<ul>
<li>R-4.2.2</li>
<li>RStudio 2022.12.0-353</li>
<li>The list of libraries in the next section</li>
</ul>
<p>To install and update:</p>
<ul>
<li>R, download the appropriate version from <a href="https://cran.r-project.org/">The Comprehensive R Archive Network (CRAN)</a></li>
<li>RStudio, download the appropriate version from <a href="https://posit.co/download/rstudio-desktop/">Posit</a></li>
</ul>
<section id="r" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="r"><span class="header-section-number">1.1</span> R?</h2>
<p>R is an open-source program that is commonly used in Statistics. It runs on almost every platform and is completely free and is available at <a href="www.r-project.org">www.r-project.org</a>. Most of the cutting-edge statistical research is first available on R.</p>
<p>R is a script based language, so there is no point and click interface. While the initial learning curve will be steeper, understanding how to write scripts will be valuable because it leaves a clear description of what steps you performed in your data analysis. Typically you will want to write a script in a separate file and then run individual lines. This saves you from having to retype a bunch of commands and speeds up the debugging process.</p>
</section>
<section id="rstudio-basics" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="rstudio-basics"><span class="header-section-number">1.2</span> R(Studio) Basics</h2>
<p>We will be running R through the program RStudio which is located at <a href="http://www.rstudio.org">rstudio.com</a>. When you first open up RStudio the console window gives you some information about the version of R you are running and then it gives the prompt <code>&gt;</code>. This prompt is waiting for you to input a command. The prompt + tells you that the current command is spanning multiple lines. In a script file you might have typed something like this:</p>
<pre><code>for( i in 1:5 ){
    print(i)
}</code></pre>
<p>Finding help about a certain function is very easy. At the prompt, just type <code>help(function.name)</code> or <code>?function.name</code>. If you don’t know the name of the function, your best bet is to go the the web page www.rseek.org which will search various R resources for your keyword(s). Another great resource is the coding question and answer site <a href="http://stackoverflow.com">stackoverflow</a>.</p>
<section id="starting-a-session-in-rstudio" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="starting-a-session-in-rstudio"><span class="header-section-number">1.2.1</span> Starting a session in RStudio</h3>
<p>Upon startup, RStudio will look something like this.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../img/environ_R_1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><em>Note</em>: the <strong>Pane Layout</strong> and <strong>Appearance</strong> settings can be altered:</p>
<ul>
<li>on Windows by clicking RStudio&gt;Tools&gt;Global Options&gt;Appearance or Pane Layout</li>
<li>on Mac OS by clicking RStudio&gt;Preferences&gt;Appearance or Pane Layout.</li>
</ul>
<p>You will also have a standard white background; but you can choose specific <a href="https://quarto.org/docs/output-formats/html-themes.html">themes</a>.</p>
<p><strong>Source Panel (Top-Left)</strong></p>
<p>This is where you write, edit, and view scripts, R Markdown/Quarto documents, or R scripts. It allows:</p>
<ul>
<li>Editing Scripts: Write and edit R scripts or documents (<code>.R</code>, <code>.Rmd</code>, <code>.qmd</code>).</li>
<li>Executing the Code: Run lines, blocks, or the entire script directly from the editor.</li>
</ul>
<p><strong>Console Panel (Bottom-Left)</strong></p>
<p><strong>The Console is the main place to run R commands interactively.</strong> It allows:</p>
<ul>
<li>Executing the Code: Type and run R commands directly.</li>
<li>Viewing outputs, warnings, and errors for immediate feedback.</li>
<li>Browsing and reusing past commands (History Tab).</li>
<li>Toggling between the R Console, and the Terminal (yuo don’t really need the latter).</li>
</ul>
<p><strong>Environment Panel (Top-Right)</strong></p>
<p>This panel helps track variables, functions, and the history of commands used. It contains:</p>
<ul>
<li>Environment Tab: Shows all current variables, datasets, and objects in your session, including their structure and values.</li>
<li>History Tab: Provides a record of past commands. You can re-run or move commands to the console or script.</li>
</ul>
<p><strong>Files / Plots / Packages / Help Panel (Bottom-Right)</strong></p>
<p>This multifunctional panel is for file navigation, plotting, managing packages, viewing help, and managing jobs. It contains:</p>
<ul>
<li>Files Tab: Navigate, open, and manage files and directories within your project.</li>
<li>Plots Tab: Displays plots generated in your session. You can export or navigate through multiple plots here.</li>
<li>Packages Tab: Lists installed packages and allows you to install, load, and update packages.</li>
<li>Help Tab: Displays help documentation for R functions, packages, and other resources. You can search for documentation by typing a function or package name.</li>
</ul>
<p><strong>Important: Unless you are working with a script, you will be likely writing code on the console.</strong></p>
<p>At the start of a session, it’s good practice clearing your R environment (console):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In R, we are going to be working with <strong>relative paths</strong>. With the command <code>getwd()</code>, you can see where your working directory is currently set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For ENVS225, download the <a href="https://github.com/GDSL-UL/stats/archive/refs/heads/main.zip">material</a> of the module an unzip it whever you like.</p>
<p>The folder structure should look like:</p>
<pre><code>stats/
├── data/
├── labs_img/
└── labs/</code></pre>
<p>You can delete other sub-folders (e.g.&nbsp;docs).</p>
<p><span style="color: red;">This should be on your personal computer or if on a local machine, I suggest using the directory M:&nbsp;to store the folder, it can be accessed from every computer.</span></p>
<p>Then, in R Studio - on Windows by clicking RStudio&gt;Tools&gt;Global Options&gt;General.. - on Mac OS by clicking RStudio&gt;Preferences&gt;Appearance or Pane Layout…</p>
<p>browse and set the folder you just creted as your working directory.</p>
<p>Check if that has been applied.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>File paths in R work like this:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th>File Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>MyFile.csv</code></td>
<td>Look in the working directory for <code>MyFile.csv</code>.</td>
</tr>
<tr class="even">
<td><code>MyFolder/MyFile.csv</code></td>
<td>In the working directory, there is a subdirectory called <code>MyFolder</code> and inside that folder is <code>MyFile.csv</code>.</td>
</tr>
</tbody>
</table>
<p>You do not need to set your working directory if you are using an R-markdown or Quarto document and you have it saved in the right location. The pathway will start from where your document is saved.</p>
</section>
<section id="using-the-console" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="using-the-console"><span class="header-section-number">1.2.2</span> Using the console</h3>
<p>Try to use the console to perform a few operations. For example type in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Slightly more complicated:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"hello world"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hello world"</code></pre>
</div>
</div>
<p>If you are unsure about what a command does, use the “Help” panel in your Files pane or type <code>?function</code> in the console. For example, to see how the <code>dplyr::rename()</code> function works, type in <code>?dplyr::rename</code>. When you see the double colon syntax like in the previous command, it’s a call to a package without loading its library.</p>
</section>
<section id="r-as-a-simple-calculator" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="r-as-a-simple-calculator"><span class="header-section-number">1.2.3</span> R as a simple calculator</h3>
<p>You can use R as a simple calculator. At the prompt, type 2+3 and hit enter. What you should see is the following</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some simple addition</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">+</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>In this fashion you can use R as a very capable calculator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">*</span><span class="dv">8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">^</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">1</span>)   <span class="co"># exp() is the exponential function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.718282</code></pre>
</div>
</div>
<p>R has most constants and common mathematical functions you could ever want. For example, the absolute value of a number is given by <code>abs()</code>, and <code>round()</code> will round a value to the nearest integer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pi     <span class="co"># the constant 3.14159265...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.141593</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="fl">1.77</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.77</code></pre>
</div>
</div>
<p>Whenever you call a function, there will be some arguments that are mandatory, and some that are optional and the arguments are separated by a comma. In the above statements the function <code>abs()</code> requires at least one argument, and that is the number you want the absolute value of.</p>
<p>When functions require more than one argument, arguments can be specified via the order in which they are passed or by naming the arguments. So for the <code>log()</code> function, for example, which calculates the logarithm of a number, one can specify the arguments using the named values; the order woudn’t matter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrating order does not matter if you specify</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># which argument is which</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">5</span>, <span class="at">base=</span><span class="dv">10</span>)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.69897</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">base=</span><span class="dv">10</span>, <span class="at">x=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.69897</code></pre>
</div>
</div>
<p>When we don’t specify which argument is which, R will decide that <code>x</code> is the first argument, and <code>base</code> is the second.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If not specified, R will assume the second value is the base...</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">5</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.69897</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">10</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.430677</code></pre>
</div>
</div>
<p>When we want to specify the arguments, we can do so using the <code>name=value</code> notation.</p>
</section>
<section id="variables-assignment" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="variables-assignment"><span class="header-section-number">1.2.4</span> Variables Assignment</h3>
<p>We need to be able to assign a value to a variable to be able to use it later. R does this by using an arrow <code>&lt;-</code> or an equal sign <code>=</code>. While R supports either, for readability, I suggest people pick one assignment operator and stick with it.</p>
<p><strong>Variable names cannot start with a number, may not include spaces, and are case sensitive.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fl">7.5</span>       <span class="co"># create two variables</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>another_var <span class="ot">=</span> <span class="dv">5</span>   <span class="co"># notice they show up in 'Environment' tab in RStudio!</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>var </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>var <span class="sc">*</span> another_var </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75</code></pre>
</div>
</div>
<p>As your analysis gets more complicated, you’ll want to save the results to a variable so that you can access the results later. <em>If you don’t assign the result to a variable, you have no way of accessing the result.</em></p>
</section>
<section id="working-with-scripts" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="working-with-scripts"><span class="header-section-number">1.2.5</span> Working with Scripts</h3>
<p><strong>R Scripts (.R files)</strong></p>
<p>Traditional script files look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem 1 </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the log of a couple of values and make a plot</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># of the log function from 0 to 3</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">0</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">1</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">2</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="dv">3</span>, <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">log</span>(x))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem 2</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the exponential function of a couple of values</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and make a plot of the function from -2 to 2</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">0</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">2</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">exp</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In RStudio you can create a new script by going to <code>File -&gt; New File -&gt; R Script</code>. This opens a new window in RStudio where you can type commands and functions as a common text editor.</p>
<p>This looks perfectly acceptable as a way of documenting what one does, but this script file doesn’t contain the actual results of commands you ran, nor does it show you the plots. Also anytime you want to comment on some output, it needs to be offset with the commenting character <code>#</code>. It would be nice to have both the commands and the results merged into one document. This is what the R Markdown file does for us.</p>
<p><strong>R Markdown (<code>.Rmd</code> and <code>.qmd</code> files)</strong></p>
<p>The R Markdown is an implementation of the Markdown syntax that makes it extremely easy to write webpages or scientific documents that include conde. This syntax was extended to allow users to embed R code directly into more complex documents. Perhaps the easiest way to understand the syntax is to look at an at the <a href="http://rmarkdown.rstudio.com">RMarkdown website</a>.</p>
<p>The R code in a R Markdown document (<code>.rmd</code> file extension) can be nicely separated from regular text using the three backticks (3 times `, see below) and an instruction that it is R code that needs to be evaluated. A code chunk will look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {<span class="fu">print</span>(i)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2
[1] 3
[1] 4
[1] 5</code></pre>
</div>
</div>
<p><strong>In ENVS225: In this module we will be using <code>.qmd</code> a more flexible development of <code>.rmd</code> files.</strong></p>
<p>Markdown files present several advantages compared to writing your code in the console or just using scripts. You’ll save yourself a huge amount of work by embracing Markdown files from the beginning; you will keep track of your code and your steps, be able to document and present how you did your analysis (helpful when writing the methods section of a paper), and it will make it easier to re-run an analysis after a change in the data (such as additional data values, transformed data, or removal of outliers) or once you spot an error. Finally, it makes the script more readable.</p>
</section>
<section id="r-packages" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6" class="anchored" data-anchor-id="r-packages"><span class="header-section-number">1.2.6</span> R Packages</h3>
<p>One of the greatest strengths about R is that so many people have developed add-on packages to do some additional function. To download and install the package from the Comprehensive R Archive Network (CRAN), you just need to ask RStudio it to install it via the menu <code>Tools</code> -&gt; <code>Install Packages...</code>. Once there, you just need to give the name of the package and RStudio will download and install the package on your computer.</p>
<p>Once a package is downloaded and installed on your computer, it is available, but it is not loaded into your current R session by default. To improve overall performance only a few packages are loaded by default and the you must explicitly load packages whenever you want to use them. You only need to load them once per session/script.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)   <span class="co"># load the dplyr library, will be useful later</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="practice-dataset-and-dataframes" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="practice-dataset-and-dataframes"><span class="header-section-number">1.3</span> Practice: Dataset and Dataframes</h2>
<blockquote class="blockquote">
<p><strong>First of all</strong>, create a new Markdown document. We use the <code>File -&gt; New File -&gt; Quarto Document..</code> dropdown option, and a menu will appear asking you for the document title, author, and preferred output type. You can select HTML, but you will need your assignment to be submitted in PDF; more on that later.</p>
<p>Follow the practical below. You can describe what you are doing in normal text. See <a href="https://quarto.org/docs/authoring/markdown-basics.html">here</a> for how to format normal text in Markdown documents</p>
<p>Remember, when you want to write code in a markdown document you have to enclose it like this:</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../img/codeChunk.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>or you can insert it manually:</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../img/codeChunk_visual.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Within this module we will be working with data stored in so-called datasets. A dataset is a structured collection of data points that represent various measurements or observations, often organized in a tabular format with rows and columns. A dataset might contain information about different locations, such as neighborhoods or cities, with each row representing a place and each column detailing characteristics like population density, average income, or number of green parks. For example, a dataset could be compiled to study patterns in urban mobility, where the data includes the number of daily commuters, the distance they travel, and the mode of transport they use. Datasets provide the essential building blocks for statistical analysis; they enable exploring relationships, identifying patterns, and drawing conclusions about certatin phenomena.</p>
<p>Examples of everyday datasets:</p>
<ul>
<li><strong>Premier League Standings</strong>: Each row represents a team, with columns for points, games played, wins, draws, and losses.</li>
<li><strong>Movie Dataset</strong>: Each row represents a movie, with columns showing its title, genre, release year, director, and rating.</li>
<li><strong>Weather Dataset</strong>: Each row shows a day’s weather in a city, with columns for temperature, humidity, wind speed, and precipitation.</li>
</ul>
<p>Usually, data is organized in</p>
<ul>
<li><strong>Columns</strong> of data representing some trait or variable that we might be interested in. In general, we might wish to investigate the relationship between variables.</li>
<li><strong>Rows</strong> represent a single object on which the column traits are measured.</li>
</ul>
<p>For example, in a grade book for recording students scores throughout the semester, their is one row for every student and columns for each assignment. A greenhouse experiment dataset will have a row for every plant and columns for treatment type and biomass.</p>
<section id="datasets-in-r" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="datasets-in-r"><span class="header-section-number">1.3.1</span> Datasets in R</h3>
<p>In R, we want a way of storing data where it feels just as if we had an Excel Spreadsheet where each row represents an observation and each column represents some information about that observation. We will call this object a <code>data.frame</code>, an R represention of a data set. The easiest way to understand data frames is to create one.</p>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Copy the code below in your markdown. Create a <code>data.frame</code> that represents an instructor’s grade book, where each row is a student, and each column represents some sort of assessment.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Grades <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name  =</span> <span class="fu">c</span>(<span class="st">'Bob'</span>,<span class="st">'Jeff'</span>,<span class="st">'Mary'</span>,<span class="st">'Valerie'</span>),     </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Exam.1 =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">75</span>, <span class="dv">92</span>, <span class="dv">85</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Exam.2 =</span> <span class="fu">c</span>(<span class="dv">87</span>, <span class="dv">71</span>, <span class="dv">95</span>, <span class="dv">81</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the data.frame </span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View(Grades)  # show the data in an Excel-like tab.  Doesn't work when knitting </span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>Grades          <span class="co"># show the output in the console. This works when knitting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Name Exam.1 Exam.2
1     Bob     90     87
2    Jeff     75     71
3    Mary     92     95
4 Valerie     85     81</code></pre>
</div>
</div>
<p><strong>To execute just one chunk of code press the green arrow top-right of the chunk:</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../img/runChunk.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>R allows two differnt was to access elements of the <code>data.frame</code>. First is a matrix-like notation for accessing particular values.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Format</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>[a,b]</code></td>
<td>Element in row <code>a</code> and column <code>b</code></td>
</tr>
<tr class="even">
<td><code>[a,]</code></td>
<td>All of row <code>a</code></td>
</tr>
<tr class="odd">
<td><code>[,b]</code></td>
<td>All of column <code>b</code></td>
</tr>
</tbody>
</table>
<p>Because the columns have meaning and we have given them column names, it is desirable to want to access an element by the name of the column as opposed to the column number.</p>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Copy and Run:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Grades[, <span class="dv">2</span>]       <span class="co"># print out all of column 2 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90 75 92 85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Grades<span class="sc">$</span>Name       <span class="co"># The $-sign means to reference a column by its label</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Bob"     "Jeff"    "Mary"    "Valerie"</code></pre>
</div>
</div>
</section>
<section id="importing-data-in-r" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="importing-data-in-r"><span class="header-section-number">1.3.2</span> Importing Data in R</h3>
<p>From: https://raw.githubusercontent.com/dereksonderegger/570L/master/07_DataImport.Rmd</p>
<p>Usually we won’t type the data in by hand, but rather load the data from some package. Reading data from external sources is a necessary skill.</p>
<p><strong><em>Comma Separated Values</em> Data</strong></p>
<p>To consider how data might be stored, we first consider the simplest file format: the comma separated values file (<code>.csv</code>). In this file time, each of the “cells” of data are separated by a comma. For example, the data file storing scores for three students might be as follows:</p>
<pre><code>Able, Dave, 98, 92, 94
Bowles, Jason, 85, 89, 91
Carr, Jasmine, 81, 96, 97</code></pre>
<p>Typically when you open up such a file on a computer with MS Excel installed, Excel will open up the file assuming it is a spreadsheet and put each element in its own cell. However, you can also open the file using a more primitive program (say Notepad in Windows, TextEdit on a Mac) you’ll see the raw form of the data.</p>
<p>Having just the raw data without any sort of column header is problematic (which of the three exams was the final??). Ideally we would have column headers that store the name of the column.</p>
<pre><code>LastName, FirstName, Exam1, Exam2, FinalExam
Able, Dave, 98, 92, 94
Bowles, Jason, 85, 89, 91
Carr, Jasmine, 81, 96, 97</code></pre>
<p><strong>Reading (<code>.csv</code>) files</strong></p>
<p>To make R read in the data arranged in this format, we need to tell R three things:</p>
<ol type="1">
<li><p>Where does the data live? Often this will be the name of a file on your computer, but the file could just as easily live on the internet (provided your computer has internet access).</p></li>
<li><p>Is the first row data or is it the column names?</p></li>
<li><p>What character separates the data? Some programs store data using tabs to distinguish between elements, some others use white space. R’s mechanism for reading in data is flexible enough to allow you to specify what the separator is.</p></li>
</ol>
<p>The primary function that we’ll use to read data from a file and into R is the function <code>read.csv()</code>. This function has many optional arguments but the most commonly used ones are outlined in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>file</code></td>
<td>Required</td>
<td>A character string denoting the file location.</td>
</tr>
<tr class="even">
<td><code>header</code></td>
<td><code>TRUE</code></td>
<td>Specifies whether the first line contains column headers.</td>
</tr>
<tr class="odd">
<td><code>sep</code></td>
<td><code>","</code></td>
<td>Specifies the character that separates columns. For <code>read.csv()</code>, this is usually a comma.</td>
</tr>
<tr class="even">
<td><code>skip</code></td>
<td><code>0</code></td>
<td>The number of lines to skip before reading data; useful for files with descriptive text before the actual data.</td>
</tr>
<tr class="odd">
<td><code>na.strings</code></td>
<td><code>"NA"</code></td>
<td>Values that represent missing data; multiple values can be specified, e.g., <code>c("NA", "-9999")</code>.</td>
</tr>
<tr class="even">
<td><code>quote</code></td>
<td><code>"</code></td>
<td>Specifies the character used to quote character strings, typically <code>"</code> or <code>'</code>.</td>
</tr>
<tr class="odd">
<td><code>stringsAsFactors</code></td>
<td><code>FALSE</code></td>
<td>Controls whether character strings are converted to factors; <code>FALSE</code> means they remain as character data.</td>
</tr>
<tr class="even">
<td><code>row.names</code></td>
<td><code>NULL</code></td>
<td>Allows specifying a column as row names, or assigning <code>NULL</code> to use default indexing for rows.</td>
</tr>
<tr class="odd">
<td><code>colClasses</code></td>
<td><code>NULL</code></td>
<td>Specifies the data type for each column to speed up reading for large files, e.g., <code>c("character", "numeric")</code>.</td>
</tr>
<tr class="even">
<td><code>encoding</code></td>
<td><code>"unknown"</code></td>
<td>Sets the text encoding of the file, which can be useful for files with special or international characters.</td>
</tr>
</tbody>
</table>
<p>Most of the time you just need to specify the file. |</p>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p>Task: Let’s read in a dataset of terrorist attacks that have taken place in the UK:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>attacks <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file   =</span> <span class="st">'../data/attacksUK.csv'</span>)  <span class="co"># where the data lives                                 </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(attacks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="practice-descriptive-statistics" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="practice-descriptive-statistics"><span class="header-section-number">1.4</span> Practice: Descriptive Statistics</h2>
<section id="summarizing-data" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="summarizing-data"><span class="header-section-number">1.4.1</span> Summarizing Data</h3>
<p>It is very important to be able to take a data set and produce summary statistics such as the mean and standard deviation of a column. For this sort of manipulation, we use the package <code>dplyr</code>. This package allows chaining together many common actions to form a particular task.</p>
<p>The foundational operations to perform on a data set are:</p>
<ul>
<li><p>Subsetting - Returns a with only particular columns or rows</p>
<p>– <code>select</code> - Selecting a subset of columns by name or column number.</p>
<p>– <code>filter</code> - Selecting a subset of rows from a data frame based on logical expressions.</p>
<p>– <code>slice</code> - Selecting a subset of rows by row number.</p></li>
<li><p><code>arrange</code> - Re-ordering the rows of a data frame.</p></li>
<li><p><code>mutate</code> - Add a new column that is some function of other columns.</p></li>
<li><p><code>summarise</code> - calculate some summary statistic of a column of data. This collapses a set of rows into a single row.</p></li>
</ul>
<p>Each of these operations is a function in the package <code>dplyr</code>. These functions all have a similar calling syntax,: - The first argument is a data set;. - Subsequent arguments describe what to do with the input data frame and you can refer to the columns without using the <code>df$column</code> notation.</p>
<p>All of these functions will return a data set.</p>
<p>The <code>dplyr</code> package also includes a function that “pipes” commands together. The idea is that the <code>%&gt;%</code> operator works by translating the command <code>a %&gt;% f(b)</code> to the expression <code>f(a,b)</code>. This operator works on any function <code>f</code>. The beauty of this comes when you have a suite of functions that takes input arguments of the same type as their output. For example if we wanted to start with <code>x</code>, and first apply function <code>f()</code>, then <code>g()</code>, and then <code>h()</code>, the usual R command would be <code>h(g(f(x)))</code> which is hard to read because you have to start reading at the innermost set of parentheses. Using the pipe command <code>%&gt;%</code>, this sequence of operations becomes <code>x %&gt;% f() %&gt;% g() %&gt;% h()</code>. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Grades <span class="co"># Recall the Grades data </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Name Exam.1 Exam.2
1     Bob     90     87
2    Jeff     75     71
3    Mary     92     95
4 Valerie     85     81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following code takes the Grades data.frame and calculates </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a column for the average exam score, and then sorts the data </span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># according to the that average score</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>Grades <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">Avg.Score =</span> (Exam<span class="fl">.1</span> <span class="sc">+</span> Exam<span class="fl">.2</span>) <span class="sc">/</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>( Avg.Score )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Name Exam.1 Exam.2 Avg.Score
1    Jeff     75     71      73.0
2 Valerie     85     81      83.0
3     Bob     90     87      88.5
4    Mary     92     95      93.5</code></pre>
</div>
</div>
<p>Keep it in mind, it is not necessary to memorise this.</p>
<p>Let’s consider the <code>summarize</code> function to calculate the mean score for <code>Exam.1</code>. Notice that this takes a data frame of four rows, and summarizes it down to just one row that represents the summarized data for all four students.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># load the library</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Grades <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>( <span class="at">Exam.1.mean =</span> <span class="fu">mean</span>( Exam<span class="fl">.1</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Exam.1.mean
1        85.5</code></pre>
</div>
</div>
<p>Similarly you could calculate the <strong>standard deviation</strong> for the exam as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Grades <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>( <span class="at">Exam.1.mean =</span> <span class="fu">mean</span>( Exam<span class="fl">.1</span> ),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">Exam.1.sd   =</span> <span class="fu">sd</span>(   Exam<span class="fl">.1</span>   ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Exam.1.mean Exam.1.sd
1        85.5  7.593857</code></pre>
</div>
</div>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task:</strong> Write the code above in your markdown file and run it. Do not to copy it this time.</p>
</div>
<p>Let’s go back to the terrorist attacks. There are attacks perpetrated by several different groups. Each record is a single attack and contains information about who perpetrated the attack, what year, how many were killed and how many were wounded. You can get a glimpse of the dataframe with the function head</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(attacks, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   nrKilled nrWound year        country                        group
1         0       0 2005 United Kingdom   Abu Hafs al-Masri Brigades
2         0       0 2005 United Kingdom   Abu Hafs al-Masri Brigades
3         0       0 2005 United Kingdom   Abu Hafs al-Masri Brigades
4         0       0 2005 United Kingdom   Abu Hafs al-Masri Brigades
5         0       1 1982 United Kingdom Abu Nidal Organization (ANO)
6         0       0 2014 United Kingdom                   Anarchists
7         0       0 2014 United Kingdom                   Anarchists
8         0       0 2014 United Kingdom                   Anarchists
9         0       0 2014 United Kingdom                   Anarchists
10        0       0 2014 United Kingdom                   Anarchists
                           attack                      target
1               Bombing/Explosion              Transportation
2               Bombing/Explosion              Transportation
3               Bombing/Explosion              Transportation
4               Bombing/Explosion              Transportation
5                   Assassination     Government (Diplomatic)
6  Facility/Infrastructure Attack                    Business
7  Facility/Infrastructure Attack                    Business
8  Facility/Infrastructure Attack                    Business
9  Facility/Infrastructure Attack Private Citizens &amp; Property
10 Facility/Infrastructure Attack                      Police
                      weapon
1  Explosives/Bombs/Dynamite
2  Explosives/Bombs/Dynamite
3  Explosives/Bombs/Dynamite
4  Explosives/Bombs/Dynamite
5                   Firearms
6                 Incendiary
7                 Incendiary
8                 Incendiary
9                 Incendiary
10                Incendiary</code></pre>
</div>
</div>
<p>We might want to compare different actors and see the mean and standard deviation of the number of people wound, by each group’s attack, across time. To do this, we are still going to use the <code>summarize</code>, but we will precede that with <code>group_by(group)</code> to tell the subsequent <code>dplyr</code> functions to perform the actions separately for each breed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>attacks <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>( group) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">Mean =</span> <span class="fu">mean</span>(attacks<span class="sc">$</span>nrWound), </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">Std.Dev =</span> <span class="fu">sd</span>(attacks<span class="sc">$</span>nrWound))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 3
   group                                               Mean Std.Dev
   &lt;chr&gt;                                              &lt;dbl&gt;   &lt;dbl&gt;
 1 Abu Hafs al-Masri Brigades                         0.963    7.22
 2 Abu Nidal Organization (ANO)                       0.963    7.22
 3 Anarchists                                         0.963    7.22
 4 Animal Liberation Front (ALF)                      0.963    7.22
 5 Animal Rights Activists                            0.963    7.22
 6 Armenian Secret Army for the Liberation of Armenia 0.963    7.22
 7 Black September                                    0.963    7.22
 8 Continuity Irish Republican Army (CIRA)            0.963    7.22
 9 Dissident Republicans                              0.963    7.22
10 Informal Anarchist Federation                      0.963    7.22
# ℹ 28 more rows</code></pre>
</div>
</div>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task:</strong> Write the code above in your markdown file and run it. Try out another categorical variable instead of <code>group</code> (e.g.&nbsp;<code>year</code>) and <code>nrKilled</code> instead of <code>nrWound</code>.</p>
</div>
<p>Let’s now move to another dataset to address a research question. For illustration purposes, we will use the <strong>Family Resources Survey (FRS)</strong>. The FRS is an annual survey conducted by the UK government that collects detailed information about the income, living conditions, and resources of private households across the United Kingdom. Managed by the Department for Work and Pensions (DWP), the FRS provides data that is essential for understanding the economic and social conditions of households and informing public policy.</p>
<p>Consider questions such as:</p>
<ul>
<li>How many respondents (persons) are there in the 2016-17 FRS?</li>
<li>How many variables (population attributes) are there?</li>
<li>What types of variables are present in the FRS?</li>
<li>What is the most detailed geography available in the FRS?</li>
</ul>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: To answer these questions, load and inspect the dataset.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the FRS dataset should be already loaded, otherwise</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>frs_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/FamilyResourceSurvey/FRS16-17.csv"</span>) </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display basic structure </span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(frs_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 44,145
Columns: 45
$ household        &lt;int&gt; 1, 1, 1, 1, 1, 2, 3, 3, 3, 3, 4, 4, 4, 5, 6, 6, 7, 7,…
$ family           &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,…
$ person           &lt;int&gt; 1, 2, 3, 4, 5, 1, 1, 2, 3, 4, 1, 2, 3, 1, 1, 2, 1, 2,…
$ country          &lt;int&gt; 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1,…
$ region           &lt;int&gt; 8, 8, 8, 8, 8, 12, 4, 4, 4, 4, 11, 11, 11, 6, 8, 8, 4…
$ age_group        &lt;int&gt; 9, 9, 2, 2, 4, 8, 8, 8, 2, 1, 13, 12, 7, 14, 7, 8, 15…
$ sex              &lt;int&gt; 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 1, 2, 1,…
$ marital_status   &lt;int&gt; 3, 3, 1, 1, 1, 1, 3, 3, 1, 1, 3, 3, 1, 1, 3, 3, 3, 3,…
$ ethnicity        &lt;int&gt; 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ hrp              &lt;int&gt; 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1,…
$ rel_to_hrp       &lt;int&gt; 1, 0, 3, 3, 4, 0, 0, 1, 4, 3, 0, 1, 3, 0, 1, 0, 1, 0,…
$ lifestage        &lt;int&gt; 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,…
$ dependent        &lt;int&gt; 2, 2, 1, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2,…
$ arrival_year     &lt;int&gt; 1995, 1995, -9, -9, -9, -9, -9, -9, -9, -9, -9, -9, -…
$ birth_country    &lt;int&gt; 8, 8, -9, -9, -9, 3, 1, 1, -9, -9, 2, 2, 2, 1, 4, 8, …
$ care_hours       &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ educ_age         &lt;int&gt; 17, 17, -9, -9, -9, 30, 21, 18, -9, -9, 19, 18, 17, 2…
$ educ_type        &lt;int&gt; 10, 0, 1, 1, 1, 4, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ fam_youngest     &lt;int&gt; 6, 6, 6, 6, 6, -1, 4, 4, 4, 4, -1, -1, -1, -1, -1, -1…
$ fam_toddlers     &lt;int&gt; 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,…
$ fam_size         &lt;int&gt; 5, 5, 5, 5, 5, 1, 4, 4, 4, 4, 2, 2, 1, 1, 2, 2, 2, 2,…
$ happy            &lt;int&gt; 1, 6, -9, -9, -9, 4, 4, -1, -9, -9, 7, 7, 7, 10, 8, -…
$ health           &lt;int&gt; 1, 1, -1, -1, 1, 2, 3, -1, -1, -1, 2, 2, 2, 3, 2, -1,…
$ hh_accom_type    &lt;int&gt; 3, 3, 3, 3, 3, 4, 1, 1, 1, 1, 1, 1, 1, 2, 4, 4, 2, 2,…
$ hh_benefits      &lt;int&gt; 2496, 2496, 2496, 2496, 2496, 0, 1768, 1768, 1768, 17…
$ hh_composition   &lt;int&gt; 6, 6, 6, 6, 6, 2, 6, 6, 6, 6, 9, 9, 9, 1, 7, 7, 5, 5,…
$ hh_ctax_band     &lt;int&gt; 4, 4, 4, 4, 4, 8, 4, 4, 4, 4, 7, 7, 7, 4, 4, 4, 2, 2,…
$ hh_housing_costs &lt;int&gt; 8060, 8060, 8060, 8060, 8060, 6604, 4108, 4108, 4108,…
$ hh_income_gross  &lt;int&gt; 29640, 29640, 29640, 29640, 29640, 17264, 78520, 7852…
$ hh_income_net    &lt;int&gt; 26884, 26884, 26884, 26884, 26884, 17264, 60112, 6011…
$ hh_size          &lt;int&gt; 5, 5, 5, 5, 5, 1, 4, 4, 4, 4, 3, 3, 3, 1, 2, 2, 2, 2,…
$ hh_tenure        &lt;int&gt; 3, 3, 3, 3, 3, 4, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1,…
$ highest_qual     &lt;int&gt; 2, 3, -9, -9, -9, 2, 1, 1, -9, -9, 3, 3, 3, 1, 1, 1, …
$ income_gross     &lt;dbl&gt; 2496, 27144, 0, 0, 0, 17264, 40924, 37596, 0, 0, -301…
$ income_net       &lt;dbl&gt; 2496, 24388, 0, 0, 0, 17264, 31772, 28340, 0, 0, -317…
$ jobs             &lt;int&gt; 0, 1, -9, -9, -9, 1, 1, 1, -9, -9, 1, 1, 1, 1, 1, 1, …
$ life_satisf      &lt;int&gt; 8, 5, -9, -9, -9, 6, 8, -1, -9, -9, 7, 7, 7, 9, 9, -1…
$ nssec            &lt;int&gt; 7, 7, 12, 12, 12, 10, 1, 3, 12, 12, 5, 3, 3, 7, 5, 3,…
$ sic_chapter      &lt;int&gt; 17, 14, -9, -9, -9, 7, 13, 13, -9, -9, 1, 17, 3, 7, 1…
$ sic_division     &lt;int&gt; 87, 80, -9, -9, -9, 47, 72, 72, -9, -9, 1, 88, 28, 47…
$ soc2010          &lt;int&gt; 6, 6, -9, -9, -9, 9, 1, 3, -9, -9, 5, 2, 3, 7, 1, 4, …
$ work_hours       &lt;dbl&gt; -2.0, 48.0, -9.0, -9.0, -9.0, 12.0, 40.0, 37.0, -9.0,…
$ workstatus       &lt;int&gt; 8, 1, -9, -9, -9, 1, 1, 1, -9, -9, 3, 1, 1, 2, 3, 1, …
$ years_ft_work    &lt;int&gt; 16, 25, -9, -9, -9, 8, 18, 15, -9, -9, 41, 30, 15, 10…
$ survey_weight    &lt;int&gt; 1870, 1870, 1870, 1870, 1870, 1083, 1571, 1571, 1571,…</code></pre>
</div>
</div>
<p>and summary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frs_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   household         family          person        country          region    
 Min.   :    1   Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   : 1.0  
 1st Qu.: 4816   1st Qu.:1.000   1st Qu.:1.00   1st Qu.:1.000   1st Qu.: 5.0  
 Median : 9673   Median :1.000   Median :2.00   Median :1.000   Median : 8.0  
 Mean   : 9677   Mean   :1.106   Mean   :1.98   Mean   :1.618   Mean   : 7.8  
 3rd Qu.:14553   3rd Qu.:1.000   3rd Qu.:3.00   3rd Qu.:2.000   3rd Qu.:11.0  
 Max.   :19380   Max.   :6.000   Max.   :9.00   Max.   :4.000   Max.   :13.0  
   age_group           sex        marital_status    ethnicity    
 Min.   : 1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.: 5.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median : 9.000   Median :2.000   Median :3.000   Median :1.000  
 Mean   : 8.707   Mean   :1.519   Mean   :2.429   Mean   :1.462  
 3rd Qu.:13.000   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:1.000  
 Max.   :16.000   Max.   :2.000   Max.   :6.000   Max.   :9.000  
      hrp          rel_to_hrp       lifestage       dependent    
 Min.   :0.000   Min.   : 0.000   Min.   :0.000   Min.   :1.000  
 1st Qu.:0.000   1st Qu.: 0.000   1st Qu.:1.000   1st Qu.:2.000  
 Median :0.000   Median : 1.000   Median :1.000   Median :2.000  
 Mean   :0.439   Mean   : 1.553   Mean   :0.773   Mean   :1.766  
 3rd Qu.:1.000   3rd Qu.: 3.000   3rd Qu.:1.000   3rd Qu.:2.000  
 Max.   :1.000   Max.   :20.000   Max.   :1.000   Max.   :2.000  
  arrival_year    birth_country       care_hours        educ_age    
 Min.   :  -9.0   Min.   :-9.0000   Min.   :0.0000   Min.   :-9.00  
 1st Qu.:  -9.0   1st Qu.: 1.0000   1st Qu.:0.0000   1st Qu.:-1.00  
 Median :  -9.0   Median : 1.0000   Median :0.0000   Median :16.00  
 Mean   : 207.4   Mean   :-0.1686   Mean   :0.2819   Mean   :11.14  
 3rd Qu.:  -9.0   3rd Qu.: 3.0000   3rd Qu.:0.0000   3rd Qu.:18.00  
 Max.   :2017.0   Max.   : 8.0000   Max.   :7.0000   Max.   :55.00  
   educ_type       fam_youngest     fam_toddlers       fam_size    
 Min.   : 0.000   Min.   :-1.000   Min.   :0.0000   Min.   :1.000  
 1st Qu.: 0.000   1st Qu.:-1.000   1st Qu.:0.0000   1st Qu.:2.000  
 Median : 0.000   Median :-1.000   Median :0.0000   Median :2.000  
 Mean   : 0.392   Mean   : 2.466   Mean   :0.2557   Mean   :2.599  
 3rd Qu.: 0.000   3rd Qu.: 5.000   3rd Qu.:0.0000   3rd Qu.:4.000  
 Max.   :10.000   Max.   :19.000   Max.   :4.0000   Max.   :9.000  
     happy            health        hh_accom_type     hh_benefits   
 Min.   :-9.000   Min.   :-1.0000   Min.   :-1.000   Min.   :    0  
 1st Qu.:-1.000   1st Qu.:-1.0000   1st Qu.: 1.000   1st Qu.:    0  
 Median : 5.000   Median : 1.0000   Median : 2.000   Median : 1768  
 Mean   : 2.197   Mean   : 0.9781   Mean   : 2.326   Mean   : 5670  
 3rd Qu.: 8.000   3rd Qu.: 2.0000   3rd Qu.: 3.000   3rd Qu.:10192  
 Max.   :10.000   Max.   : 5.0000   Max.   : 7.000   Max.   :54080  
 hh_composition    hh_ctax_band   hh_housing_costs hh_income_gross  
 Min.   : 1.000   Min.   :1.000   Min.   :    -1   Min.   :-326092  
 1st Qu.: 5.000   1st Qu.:2.000   1st Qu.:   572   1st Qu.:  22256  
 Median : 6.000   Median :3.000   Median :  2704   Median :  35984  
 Mean   : 5.474   Mean   :3.198   Mean   :  3820   Mean   :  46076  
 3rd Qu.: 6.000   3rd Qu.:4.000   3rd Qu.:  5616   3rd Qu.:  57252  
 Max.   :10.000   Max.   :8.000   Max.   :135720   Max.   :1165216  
 hh_income_net        hh_size       hh_tenure      highest_qual     
 Min.   :-334776   Min.   :1.00   Min.   :1.000   Min.   :-9.00000  
 1st Qu.:  20748   1st Qu.:2.00   1st Qu.:1.000   1st Qu.: 1.00000  
 Median :  31512   Median :3.00   Median :2.000   Median : 2.00000  
 Mean   :  37447   Mean   :2.96   Mean   :2.369   Mean   : 0.04098  
 3rd Qu.:  47008   3rd Qu.:4.00   3rd Qu.:3.000   3rd Qu.: 3.00000  
 Max.   :1116596   Max.   :9.00   Max.   :5.000   Max.   : 5.00000  
  income_gross       income_net           jobs         life_satisf   
 Min.   :-354848   Min.   :-358592   Min.   :-9.000   Min.   :-9.00  
 1st Qu.:     52   1st Qu.:      0   1st Qu.: 0.000   1st Qu.:-1.00  
 Median :  12740   Median :  12012   Median : 0.000   Median : 6.00  
 Mean   :  17305   Mean   :  14204   Mean   :-1.644   Mean   : 2.23  
 3rd Qu.:  23712   3rd Qu.:  20384   3rd Qu.: 1.000   3rd Qu.: 8.00  
 Max.   :1127360   Max.   :1110928   Max.   : 4.000   Max.   :10.00  
     nssec         sic_chapter      sic_division      soc2010      
 Min.   : 1.000   Min.   :-9.000   Min.   :-9.00   Min.   :-9.000  
 1st Qu.: 3.000   1st Qu.:-2.000   1st Qu.:-2.00   1st Qu.:-2.000  
 Median : 7.000   Median : 7.000   Median :47.00   Median : 3.000  
 Mean   : 6.707   Mean   : 5.351   Mean   :40.85   Mean   : 1.229  
 3rd Qu.:10.000   3rd Qu.:15.000   3rd Qu.:84.00   3rd Qu.: 6.000  
 Max.   :12.000   Max.   :21.000   Max.   :99.00   Max.   : 9.000  
   work_hours       workstatus      years_ft_work   survey_weight  
 Min.   : -9.00   Min.   :-9.0000   Min.   :-9.00   Min.   :  221  
 1st Qu.: -2.00   1st Qu.: 1.0000   1st Qu.:-1.00   1st Qu.: 1097  
 Median : -2.00   Median : 1.0000   Median :11.00   Median : 1380  
 Mean   : 12.75   Mean   : 0.8902   Mean   :14.15   Mean   : 1459  
 3rd Qu.: 37.00   3rd Qu.: 6.0000   3rd Qu.:30.00   3rd Qu.: 1742  
 Max.   :150.00   Max.   :11.0000   Max.   :73.00   Max.   :39675  </code></pre>
</div>
</div>
</section>
<section id="understanding-the-structure-of-the-frs-datafile" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="understanding-the-structure-of-the-frs-datafile"><span class="header-section-number">1.4.2</span> Understanding the Structure of the FRS Datafile</h3>
<p>In the FRS data structure, each row represents a person, but:</p>
<ul>
<li>Each person is nested within a family.</li>
<li>Each family is nested within a household.</li>
</ul>
<p>Below is an example dataset structure:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 21%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>household</th>
<th>family</th>
<th>person</th>
<th>region</th>
<th>age_group</th>
<th>sex</th>
<th>marital_status</th>
<th>rel_to_hrp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>1</td>
<td>London</td>
<td>40-44</td>
<td>Female</td>
<td>Married/Civil partnership</td>
<td>Spouse</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>2</td>
<td>London</td>
<td>40-44</td>
<td>Male</td>
<td>Married/Civil partnership</td>
<td>Household Representative</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>3</td>
<td>London</td>
<td>5-10</td>
<td>Male</td>
<td>Single</td>
<td>Son/daughter (incl.&nbsp;adopted)</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>4</td>
<td>London</td>
<td>5-10</td>
<td>Female</td>
<td>Single</td>
<td>Son/daughter (incl.&nbsp;adopted)</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>5</td>
<td>London</td>
<td>16-19</td>
<td>Male</td>
<td>Single</td>
<td>Step-son/daughter</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>1</td>
<td>Scotland</td>
<td>35-39</td>
<td>Male</td>
<td>Single</td>
<td>Household Representative</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>1</td>
<td>Yorks and the Humber</td>
<td>35-39</td>
<td>Female</td>
<td>Married/Civil partnership</td>
<td>Household Representative</td>
</tr>
<tr class="even">
<td>3</td>
<td>1</td>
<td>2</td>
<td>Yorks and the Humber</td>
<td>35-39</td>
<td>Male</td>
<td>Married/Civil partnership</td>
<td>Spouse</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>3</td>
<td>Yorks and the Humber</td>
<td>5-10</td>
<td>Male</td>
<td>Single</td>
<td>Step-son/daughter</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
<td>1</td>
<td>Wales</td>
<td>0-4</td>
<td>Male</td>
<td>Single</td>
<td>Son/daughter (incl.&nbsp;adopted)</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1</td>
<td>2</td>
<td>Wales</td>
<td>60-64</td>
<td>Male</td>
<td>Married/Civil partnership</td>
<td>Household Representative</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
<td>3</td>
<td>Wales</td>
<td>55-59</td>
<td>Female</td>
<td>Married/Civil partnership</td>
<td>Spouse</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2</td>
<td>3</td>
<td>Wales</td>
<td>30-34</td>
<td>Female</td>
<td>Single</td>
<td>Son/daughter (incl.&nbsp;adopted)</td>
</tr>
</tbody>
</table>
<p>The first five people in the FRS all belong to the same household (household 1); they also all belong to the same family. This family comprises a married middle-aged couple plus their three children, one of whom is a stepson.</p>
<p>The second household (household 2) comprises only one person – a single middle-aged male.The third household comprises another married couple, this time with two children.</p>
<p>Superficially the fourth household looks similar to households 1 and 2: a married couple plus their daughter. The difference is that this particular married couple is nearing retirement age, and their daughter is middle-aged. Consequently, despite being a child of the married couple, the middle-aged daughter is treated as a separate ‘family’ (family 2 in the household). This is because the FRS (and Census) define a ‘family’ as a couple plus any ‘dependent’ children. A dependent child is defined as a child who is either` aged 0-15 or aged 16-19, unmarried and in full-time education. All children aged 16-19 who are married or no longer in full-time education are regarded as ‘independent’ adults who form their own family unit, as are all children aged 20+.</p>
<p>The inclusion of all persons in a household allows us more flexibility in the types of research question we can answer. For example, we could explore how the likelihood of a woman being in paid employment <code>WorkStatus</code> is influenced by the age of the youngest child still living in her family (if any) <code>fam_youngest</code>.</p>
<p>In the FRS (and Census), a “family” is defined as a couple and any “dependent” children. Dependent children are defined as those aged 0–15, or aged 16–19 if unmarried and in full-time education.</p>
</section>
<section id="explore-the-distribution-of-your-outcome-variable" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="explore-the-distribution-of-your-outcome-variable"><span class="header-section-number">1.4.3</span> Explore the Distribution of Your Outcome Variable</h3>
<p>Before starting your analysis, it is critical to know the type of scale used to measure your outcome variable: is it categorical or continuous? Here we will start off by exploring a continuous variable which can then turn into a categorical variable (e.g.&nbsp;top earners: yes or no). We explore the income distribution in the UK by first looking at the low and high end of the distribution ie. What sorts of people have high (or low) incomes?</p>
<p>In the FRS each person’s annual income is recorded, both gross (pre-tax) and net (post-tax). This income includes all income sources, including earnings, profits, investment returns, state benefits, occupational pensions etc. As it is possible to make a loss on some of these activities, it is also possible (although unusual) for someone’s gross or net annual income in a given year to be negative (representing an overall loss).</p>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Load the FRS dataset into your R environment, if it’s not already loaded, and inspect the data.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset (replace 'frs_data.csv' with the actual file path)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>frs_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/FamilyResourceSurvey/FRS16-17.csv"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Open the dataset in RStudio’s <strong>Data Viewer</strong> to explore its structure, including the <code>income_gross</code> and <code>income_net</code> variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Open the data in the RStudio Viewer</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">View</span>(frs_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>in the <strong>Data Viewer</strong> tab, scroll horizontally to locate the <code>income_gross</code> and <code>income_net</code> columns. If columns are listed alphabetically, they will appear near other attributes that start with “income.”</p>
<p>You should notice two things:</p>
<ul>
<li>Incomes are recorded to the nearest £, NOT in income bands.</li>
<li>Dependent children almost all have a recorded income of £0.</li>
</ul>
<p>This second observation highlights the somewhat loose wording of our question above (<em>What sorts of people have high (or low) incomes?</em>). To avoid reaching the somewhat banal conclusion that those with the lowest of all incomes are almost all children, we should re-frame the question more precisely as <em>What sorts of people (excluding dependent children) have low incomes?</em></p>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Determine the Scale of the Outcome Variable.</p>
</div>
<p>**</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize income variables</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frs_data<span class="sc">$</span>income_gross)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-354848      52   12740   17305   23712 1127360 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize income variables</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frs_data<span class="sc">$</span>income_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-358592       0   12012   14204   20384 1110928 </code></pre>
</div>
</div>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Exclude Dependent Children.</p>
</div>
<p>**</p>
<p>You need to select all cases (persons) that are independent, that is where the variable dependent has value 2 (1 = dependent, 2 = independent).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to include only independent persons</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>frs_independent <span class="ot">&lt;-</span> frs_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dependent <span class="sc">==</span> <span class="st">"2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Create a basic histogram (a visualisation lecture is scheduled later on).</p>
</div>
<p>The income variables in the FRS are all scale variables so a good starting point is to examine its distribution looking at a histogram of <code>income_gross</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(frs_independent, <span class="fu">aes</span>(<span class="at">x =</span> income_gross)) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5000</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Distribution of Gross Household Income"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">x =</span> <span class="st">"Gross Income (£)"</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">90000</span>) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01.introR_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You should see the histogram below. It reveals that the income distribution is very skewed with few people earning high salaries and the majority earning just over or less 35,000 annually.</p>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Adopt a regrouping strategy.</p>
</div>
<p>**</p>
<p>You can also cross-tabulate gross (or net) income with any of the other variables in the FRS to your heart’s content – or can you?</p>
<p>Again, here is important to recall that the income variables in the FRS are all ‘scale’ variables; in other words, they are precise measures rather than broad categories. Consequently, every single person in the FRS potentially has their own unique income value. That could make for a table c.&nbsp;44,000 rows long (one row per person) if each person has their own unique value. The solution is to create a categorical version of the original income variable by assigning each person to one of a set of income categories (income bands). Having done this, cross-tabulation then becomes possible.</p>
<p>But which strategy to use? Equal intervals, percentiles or ‘ad hoc’. Here I would suggest that ‘ad hoc’ is best: all you want to do is to allocate each independent adult to one of three arbitrarily defined groups: ‘low’, ‘middle’ and ‘high’ income. <strong>Define <code>Low</code> and <code>High</code> Income Thresholds</strong></p>
<p>Define thresholds for income categories:</p>
<ul>
<li>Low-income threshold: £________</li>
<li>High-income threshold: £_______</li>
</ul>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Create a New Variable Based on Regrouping of Original Variable.</p>
</div>
<p>Recode <code>income_gross</code> into categories based on the chosen thresholds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define thresholds for income categories </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>LOW_THRESHOLD <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># Replace with the upper limit for low income </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>HIGH_THRESHOLD <span class="ot">&lt;-</span> <span class="dv">50000</span> <span class="co"># Replace with the lower limit for high income </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define income categories based on thresholds </span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>frs_independent <span class="ot">&lt;-</span> frs_independent <span class="sc">%&gt;%</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">income_category =</span> <span class="fu">case_when</span>( </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>        income_gross <span class="sc">&lt;=</span> LOW_THRESHOLD <span class="sc">~</span> <span class="st">"Low"</span>, </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>        income_gross <span class="sc">&gt;=</span> HIGH_THRESHOLD <span class="sc">~</span> <span class="st">"High"</span>, </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Middle"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>mutate()</code> function in R, from the <strong>dplyr</strong> package, is used to add or modify columns in a data frame. It allows you to create new variables or transform existing ones by applying calculations or conditional statements directly within the function.</p>
<p>Explanation of the code</p>
<ul>
<li><strong><code>frs_independent %&gt;%</code></strong>: The pipe operator <code>%&gt;%</code> sends <code>frs_independent</code> into <code>mutate()</code>, allowing us to apply transformations without reassigning it repeatedly.</li>
<li><strong><code>mutate()</code></strong>: Starts the transformation process by defining new or modified columns.</li>
<li><strong><code>income_category = case_when(...)</code></strong>:
<ul>
<li>This creates a new column named <code>income_category</code>.</li>
<li>The <code>case_when()</code> function defines conditions for assigning values to this new column.</li>
</ul></li>
<li><strong><code>case_when()</code></strong>:
<ul>
<li><code>case_when()</code> is used here to assign categorical labels based on conditions.</li>
<li><code>income_gross &lt;= LOW_THRESHOLD ~ "Low"</code>: If <code>income_gross</code> is less than or equal to <code>LOW_THRESHOLD</code>, <code>income_category</code> will be labeled “Low.”</li>
<li><code>income_gross &gt;= HIGH_THRESHOLD ~ "High"</code>: If <code>income_gross</code> is greater than or equal to <code>HIGH_THRESHOLD</code>, <code>income_category</code> will be labeled “High.”</li>
<li><code>TRUE ~ "Middle"</code>: Any values not meeting the previous conditions are labeled “Middle.”</li>
</ul></li>
</ul>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Add some Metadata.</p>
</div>
<p>Define metadata for the new variable by labeling income categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add metadata by converting to a factor and defining labels</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>frs_independent<span class="sc">$</span>income_category <span class="ot">&lt;-</span> <span class="fu">factor</span>(frs_independent<span class="sc">$</span>income_category,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Middle"</span>, <span class="st">"High"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;= £10,000"</span>, <span class="st">"£10,001 - £49,999"</span>, <span class="st">"&gt;= £50,000"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="background-color: #FFFBCC; padding: 10px; border-radius: 5px; border: 1px solid #E1C948;">
<p><strong>Task</strong>: Check your work.</p>
</div>
<p>Examine the frequency distribution of the variable you have just created. Both variables should have the same number of missing cases, unless:</p>
<ul>
<li>Missing cases in the old variable have been intentionally converted into valid cases in the new variable.</li>
<li>You forgot to allocate a new value to one of the old variable categories, in which case the new variable will have more missing cases than the old variable.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency distribution of income categories</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(frs_independent<span class="sc">$</span>income_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       &lt;= £10,000 £10,001 - £49,999        &gt;= £50,000 
             8584             22981              2271 </code></pre>
</div>
</div>
<p>After preparing the data, use cross-tabulations to compare income levels across demographic groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-tabulate income category by age group, nationality, etc.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(frs_independent<span class="sc">$</span>income_category, frs_independent<span class="sc">$</span>age_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   
                       4    5    6    7    8    9   10   11   12   13   14   15
  &lt;= £10,000         373  680  492  558  474  511  554  652  781  826  773  744
  £10,001 - £49,999  263 1241 1802 2056 2052 1948 1995 1967 1749 1772 2073 1554
  &gt;= £50,000           1    8   59  186  314  331  334  356  237  177  144   56
                   
                      16
  &lt;= £10,000        1166
  £10,001 - £49,999 2509
  &gt;= £50,000          68</code></pre>
</div>
</div>
<p>Explore income distribution across different regions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-tabulate income category by region</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(frs_independent<span class="sc">$</span>income_category, frs_independent<span class="sc">$</span>region) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   
                       1    2    4    5    6    7    8    9   10   11   12   13
  &lt;= £10,000         357  878  670  562  744  665  740  895  588  399 1212  874
  £10,001 - £49,999  979 2347 1728 1550 1892 1855 1850 2563 1707  971 3234 2305
  &gt;= £50,000          48  174  114  135  164  245  367  367  149   63  322  123</code></pre>
</div>
</div>
<p><strong>Tips for Cross-Tabulation</strong></p>
<ul>
<li>Place the income variable in the columns.</li>
<li>Add multiple variables in the rows to create simultaneous cross-tabulations.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/gdsl-ul\.github\.io\/stats");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../general/assessment.html" class="pagination-link" aria-label="Assessment">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assessment</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../labs/02.MultipleLinear.html" class="pagination-link" aria-label="Lab: Correlation, Single, and Multiple Linear Regression">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lab: Correlation, Single, and Multiple Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Exploring the Social World - Quantitative Block: Statistics by Gabriele Filomena and Zi Ye.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/GDSL-UL/stats/edit/main/labs/01.introR.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>